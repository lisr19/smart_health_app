<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>百科药品列表</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="css/style.css" />
		<link rel="stylesheet" href="css/swiper.min.css" />
		<script type="text/javascript" src="js/rem.js"></script>
		<script type="text/javascript" src="js/iconfont.js"></script>
	</head>

	<body>

		<div class="header" style="background-image: url(img/background.svg);background-size:cover;height: 1.4rem;">
			<div class="baike-header">
				<div class="baike-header-left" id="back">
					<img src="img/return.png" />
				</div>
				<div class="baike-input">
					<input type="text" id="searchValue" placeholder="请输入药品/健康知识/疾病 进行查询" 
						onfocus="this.placeholder=''"
						 onblur="this.placeholder='请输入药品/健康知识/疾病 进行查询'" />
				</div>
				<div class="baike-search-img" id="search"/>
				   <img  src="img/Shape.png" />
				</div>
			</div>
		</div>
		<div class="mui-scroll-wrapper" style="margin-top: 1.4rem;" id="yaopin-from">
			<div class="mui-scroll">
				<!--主内容区-->
				<div class="baikelist">
					<div class="baikelist-title">
						常见中成药
						<span id="quanbu">查看全部分类</span>
					</div>
					<!--单个药品-->
					<div  v-for="(item,index) in zhongchengyaoList" :yaopinInfo='index'   class="baikelist-option">
						<div class="baikelist-option-left">
							<img v-if="item.imageUrl != 'http://img.39.net/ypk/images/nopic.gif'" :src="item.imageUrl" />
							<img v-if="item.imageUrl == 'http://img.39.net/ypk/images/nopic.gif'" src="img/yaocai.jpg" />
						</div>
						<div class="baikelist-option-right">
							<div class="baikelist-option-right-title">
								{{item.name}}
								<button>查看</button>
							</div>
							<p>
								{{item.functionalManage}}
							</p>

						</div>
					</div>
				
				</div>
				
				<div class="baikelist">
					<div class="baikelist-title">
						常见中药
						
					</div>
					<!--单个药品-->
					<div  v-for="(item,index) in zhongyaoList"  :yaopinInfo='index'  class="baikelist-option-z">
						<div class="baikelist-option-left">
							<img v-if="item.imageUrl != 'http://img.39.net/ypk/images/nopic.gif'" :src="item.imageUrl" />
							<img v-if="item.imageUrl == 'http://img.39.net/ypk/images/nopic.gif'" src="img/yaocai.jpg" />
						</div>
						<div class="baikelist-option-right">
							<div class="baikelist-option-right-title">
								{{item.name}}
								<button>查看</button>
							</div>
							<p>
								{{item.functionalManage}}
							</p>

						</div>
					</div>
				
				</div>
				<!--主内容区结束-->
             <div style="width: 7.5rem;height: 0.3rem;"></div>
             <div class="fool"><span id="quanbu2">点击查看全部分类</span></div>
			</div>
		</div>
		<script type="text/javascript" src="js/mui.min.js"></script>
		<script type="text/javascript" src="js/vue.js"></script>
		<script type="text/javascript" src="js/swiper.min.js"></script>
		<script type="text/javascript" src="js/configUrl.js" ></script>
		<script>
			mui.init();
			var vm = new Vue({
				el:'#yaopin-from',
				data:{
					zhongchengyaoList:'',
					zhongyaoList:''
					
				}
			})
			
			mui.plusReady(function() {

				//滚动
				mui('.mui-scroll-wrapper').scroll({
					scrollY: true,
					deceleration: 0.0003,
					indicators: false
				});

				//监听药品百科
				document.getElementById('quanbu').addEventListener('tap', function() {
					mui.openWindow({
						url: 'healthyEncyclopediaSearch.html',
						id: 'healthyEncyclopediaSearch'
					})
				});
				
				//监听药品百科
				document.getElementById('quanbu2').addEventListener('tap', function() {
					mui.openWindow({
						url: 'healthyEncyclopediaSearch.html',
						id: 'healthyEncyclopediaSearch'
					})
				});
				
				//查看中成药品详情
				mui(".baikelist").on('tap', '.baikelist-option', function() {  
				   
				   var thisYaopin = this;
				   
				   var yaopinInfo = thisYaopin.getAttribute('yaopinInfo');
				   				   				   
				   localStorage.setItem('yaopinInfo',JSON.stringify(vm.zhongchengyaoList[yaopinInfo]));
				   				   
				   mui.openWindow({
				   	url:'healthOne.html',
				   	id:'healthOne',
				   })
				   
				
				});
				
				//查看中药详情
				mui(".baikelist").on('tap', '.baikelist-option-z', function() {  
				   
				   var thisYaopin = this;
				   
				   var yaopinInfo = thisYaopin.getAttribute('yaopinInfo');
				   				   				   
				   localStorage.setItem('yaopinInfo',JSON.stringify(vm.zhongyaoList[yaopinInfo]));
				   				   
				   mui.openWindow({
				   	url:'healthOne.html',
				   	id:'healthOne',
				   })
				   
				
				});
				
				
				
				//监听返回
				document.getElementById('back').addEventListener('tap', function() {
					mui.back();
				});
				
				
				//查询结果
				document.getElementById('search').addEventListener('tap', function() {
					
					var searchValue = document.getElementById('searchValue').value;
					mui.openWindow({
						url:'healthyEncyclopediaResult.html',
						id:'healthyEncyclopediaResult',
						extras:{
							searchValue:searchValue
						}
					})
					
				});
				
				
				//查询结果
				document.getElementById('searchValue').addEventListener('keypress', function(event) {
					
					
					 if(event.keyCode == "13") {
                      document.activeElement.blur();//收起虚拟键盘
                      var searchValue = document.getElementById('searchValue').value;
					  mui.openWindow({
						url:'healthyEncyclopediaResult.html',
						id:'healthyEncyclopediaResult',
						extras:{
							searchValue:searchValue
						}
					})
                   }
					
					
					
				});
				
				loadYaopin();
				
				loadZYaopin();

			});
			
			
			
			//中成药
			function loadYaopin(){
				
				var token = localStorage.getItem('token');
				var phone = localStorage.getItem('phone');
				
				mui.ajax(baseUrl+'/drug/findList',{
					headers: {
						'Authorization': token,
						phone: phone
					},
					data:{
						page:1,
						limit:5,
						category:1,//1为中成药
						type:31
					},
					dataType:'json',//服务器返回json格式数据
					type:'get',//HTTP请求类型
					timeout:10000,//超时时间设置为10秒；
					success:function(data){
						
						var dataJson = data.data.data;
						vm.zhongchengyaoList = dataJson;
						
						
						
					},
					error:function(xhr,type,errorThrown){
						
					}
				});
				
				
				
			}
			
			//中药
			function loadZYaopin(){
				
				var token = localStorage.getItem('token');
				var phone = localStorage.getItem('phone');
				
				mui.ajax(baseUrl+'/drug/findList',{
					headers: {
						'Authorization': token,
						phone: phone
					},
					data:{
						page:1,
						limit:5,
						category:2,//2为中药
						type:15
					},
					dataType:'json',//服务器返回json格式数据
					type:'get',//HTTP请求类型
					timeout:10000,//超时时间设置为10秒；
					success:function(data){
						
						var dataJson = data.data.data;
						vm.zhongyaoList = dataJson;
						
						
						
					},
					error:function(xhr,type,errorThrown){
						
					}
				});
				
				
				
			}
			
		</script>
	</body>

</html>